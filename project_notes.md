# Telegram GPT Assistant - Project Notes

## Цель проекта

Создание GPT-ассистента для анализа Telegram-чатов/групп/каналов, который демонстрирует навыки разработчика в областях:

*   **Разработка на Python:**  Написание чистого, модульного, асинхронного кода.
*   **Telegram API:**  Взаимодействие с Telegram API с помощью библиотеки `Telethon`.
*   **MLOps:**  Интеграция с LLM (Large Language Model) для анализа текста.
*   **DevOps:**  Использование Git/GitHub, виртуальных окружений, (в будущем) контейнеризация.

## Целевая аудитория

*   **MVP:**  Разработчик проекта (для демонстрации навыков и создания полезного инструмента для себя).
*   **Потенциальная:**  Любой пользователь Telegram, заинтересованный в расширенной аналитике чатов/групп/каналов (исследователи, маркетологи, аналитики, администраторы сообществ и т.д.).

## MVP (Minimum Viable Product)

### Функциональность

1.  **Добавление источников:**
    *   Возможность добавлять Telegram-чаты, группы и каналы для анализа (по ID, username или ссылке-приглашению).
    *   _(В будущем: автоматическое обнаружение каналов/групп по ключевым словам)_

2.  **Сбор данных:**
    *   Загрузка истории сообщений из добавленных источников.
    *   Отслеживание новых сообщений в режиме, близком к реальному времени.
     *   Загрузка данных из экспорта истории Telegram (формат JSON).

3.  **Обработка данных:**
    *   Загрузка: текст, эмодзи, ссылки, (в будущем) изображения.
    *   Токенизация текста с использованием `spaCy`.
    *   Обработка эмодзи (замена на текстовые описания).
    *   _(В будущем: OCR для извлечения текста с изображений)._

4.  **Интеграция LLM:**
    *   Подключение внешней LLM через API (Google Gemini API).
    *   _(В будущем: возможность использования локальных LLM)._
    *   Возможности LLM:
        *   Анализ и семантический поиск по темам.
        *   Ответы на вопросы по темам чата (с указанием участников и ссылками на сообщения).
        *   Генерация саммари (кратких сводок) по чатам.
        *   _(В будущем: атрибуция участников по уровню доверия и типу активности)._

5.  **Поиск:**
    * Поиск по ID, username, номеру телефона
    * Поиск по контактам first/last name
    * Поиск по названию title

6.  **Use Case (пример):**
    *   Пользователь добавляет несколько чатов в систему.
    *   Задает вопрос, касающийся информации из этих чатов.
    *   Система, используя LLM, анализирует сообщения, находит релевантную информацию и предоставляет ответ (саммари, ссылки на сообщения, список экспертов и т.д.).

## Технологический стек

*   **Python:** 3.12
*   **Telegram API:** `Telethon`
*   **LLM:** Google Gemini API (пока через API)
*   **NLP:** `spaCy`, `emoji`, `nltk`, `razdel` (по необходимости)
*   **Хранение данных:**  (Пока) JSON, (в будущем) SQLite / PostgreSQL
*   **Тестирование:** `pytest`, `pytest-asyncio`, `unittest.mock` (AsyncMock, patch)
*   **Управление зависимостями:** `venv`
*   **Контроль версий:** Git, GitHub
* **Rate Limiting**: `aiolimiter`

## Принципы разработки

*   **Модульность:**  Код разбит на логические модули (`telegram_connector.py`, `main.py`, ...).
*   **Асинхронность:**  Использование `asyncio` и `Telethon` для эффективной работы с Telegram API.
*   **Обработка ошибок:**  Корректная обработка исключений (особенно `FloodWaitError`, `PeerIdInvalidError`, `ChatIdInvalidError`).
*   **Rate Limiting:**  Использование `aiolimiter` для предотвращения блокировок со стороны Telegram API.
*   **Тестирование:**  Покрытие кода тестами (юнит-тесты, интеграционные тесты).
*   **Чистый код:**  Следование PEP 8, использование понятных имен переменных и функций, комментарии.
* **Использование переменных окружения**

## Текущее состояние (Roadmap, что сделано):

*   [x] Настройка окружения (виртуальное окружение, установка библиотек).
*   [x] Подключение к Telegram API (аутентификация, получение информации о пользователе).
*   [x] Добавление чатов/каналов/групп по ID, username, номеру телефона.
*   [x] Получение информации о сущности (пользователь, чат, канал) по ID, username, номеру телефона.
*   [x] Поиск пользователей в контактах по имени и фамилии.
*   [x] Поиск диалогов по названию.
*   [x] Экспорт списка диалогов пользователя в CSV.
*   [x] Загрузка данных из JSON-файла экспорта Telegram.
*   [x] Написание тестов (`pytest`, `pytest-asyncio`, `unittest.mock`).
*   [ ] Токенизация текста (`spaCy`).
*   [ ] Интеграция с Google Gemini API.
*   [ ] Реализация основного use case (вопрос-ответ).
*   [ ] Реализация отслеживания новых сообщений.
*   [ ] ... (дальнейшее развитие)

## Структура проекта

